# Canonical Event Types for AetherLink

This document defines the standardized event type prefixes for AetherLink and its umbrella apps. These ensure consistent naming across the platform, enabling reliable routing, analytics, and cross-program communication via the event bus.

## 1. Core / Platform (AetherLink itself)

These are events generated by the Command Center platform:

* `core.startup` — service booted, warm-boot, self-heal
* `core.restart` — POST /ops/restart was called
* `core.persistence.restore` — self-healed from .bak (already logged in audit)
* `core.replication.degraded` / `core.replication.recovered`
* `core.scheduler.auto_pause` / `core.scheduler.auto_recover`

**Why:** Separates platform-level events from business events for operational visibility.

## 2. Scheduler (Phases IX–XIII)

All tenant-auto-sync operations:

* `scheduler.import.requested` — operator clicked "Run now"
* `scheduler.import.completed` — loop ran and succeeded
* `scheduler.import.failed` — loop ran and failed
* `scheduler.schedule.created` — POST /api/.../schedule
* `scheduler.schedule.paused` — POST /pause
* `scheduler.schedule.resumed` — POST /resume
* `scheduler.schedule.deleted` — DELETE /schedule

**Why:** Makes existing audit logs queryable as events.

## 3. PeakPro CRM

UI vertical operations:

* `crm.record.created`
* `crm.record.updated`
* `crm.record.deleted`
* `crm.attachment.added`
* `crm.sync.started`
* `crm.sync.completed`
* `crm.sync.failed`
* `crm.sync.autosync.enabled` (5m, 15m, etc.)
* `crm.sync.autosync.disabled`

## 4. Policy / Claims app

* `policy.claim.created`
* `policy.claim.updated`
* `policy.claim.closed`
* `policy.compliance.flagged`
* `policy.docs.attached`

## 5. Finance / Billing / Ops

* `finance.invoice.created`
* `finance.invoice.synced`
* `finance.invoice.paid`
* `finance.charge.failed`
* `finance.export.completed`

## 6. Agent / Operator Actions

Normalized from `/api/local/run`:

* `ops.local.run.requested` — user clicked button in AgentActionsPanel
* `ops.local.run.completed`
* `ops.local.run.failed`

These map directly to `LOCAL_ACTION_RUNS` persistence.

## 7. Security / RBAC

* `security.rbac.denied` — protected endpoint hit without `x-ops`
* `security.rbac.allowed` — optional for high-audit tenants
* `security.config.changed` — RBAC mode changes

## Event Emission Pattern

When emitting events, use this structure:

```python
# In Python backend
await emit_event({
    "source": "command-center",  # or "peakpro", "policypal", etc.
    "tenant": tenant,
    "type": "scheduler.import.completed",
    "payload": {
        "import_id": "...",
        "records_processed": 42,
        # ... specific data
    }
})
```

```typescript
// In UI/API
await fetch("/bus/events", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "x-tenant": tenant,
    "x-ops": "1"
  },
  body: JSON.stringify({
    source: "peakpro",
    type: "crm.record.updated",
    payload: {
      record_id: id,
      changes: diff
    }
  })
});
```

The Command Center will persist, audit, replicate, and route these events automatically.